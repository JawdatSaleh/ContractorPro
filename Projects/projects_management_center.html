<!DOCTYPE html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>مركز إدارة المشاريع | ContractorPro</title>
    <link rel="stylesheet" href="../css/main.css" />
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="css/projects.css" />
    <link rel="stylesheet" href="css/responsive.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" />
  </head>
  <body class="projects-module" data-page="projects-management">
    <div class="projects-shell">
      <aside class="projects-sidebar fade-in">
        <div class="projects-sidebar__logo">
          <div class="projects-sidebar__logo-icon">
            <i class="fas fa-hard-hat"></i>
          </div>
          <div>
            <strong>ContractorPro</strong>
            <p>منصة المقاولات المتكاملة</p>
          </div>
        </div>
        <nav>
          <a href="../pages/main_dashboard.html">
            <i class="fas fa-gauge"></i>
            <span>اللوحة الرئيسية</span>
          </a>
          <a href="projects_management_center.html" class="active">
            <i class="fas fa-city"></i>
            <span>إدارة المشاريع</span>
          </a>
          <a href="../pages/financial_management_center.html">
            <i class="fas fa-coins"></i>
            <span>المركز المالي</span>
          </a>
          <a href="../pages/human_resources_center.html">
            <i class="fas fa-user-tie"></i>
            <span>الموارد البشرية</span>
          </a>
          <a href="../pages/financial_operations_dashboard.html">
            <i class="fas fa-chart-line"></i>
            <span>العمليات المالية</span>
          </a>
        </nav>
      </aside>

      <main class="projects-content projects-content--canvas fade-in">
        <div class="project-page-bar">
          <header class="projects-header projects-header--compact">
            <div>
              <nav class="breadcrumb" data-breadcrumb>
                <span class="breadcrumb-item">الوحدات</span>
                <span class="breadcrumb-divider">/</span>
                <span class="breadcrumb-item">إدارة المشاريع</span>
              </nav>
              <h1>محفظة المشاريع</h1>
              <p class="text-muted">متابعة المشاريع، تتبع الأداء المالي والتشغيلي، واتخاذ قرارات أسرع.</p>
            </div>
            <div class="projects-actions">
              <button id="newProjectBtn" class="btn btn-primary">
                <i class="fas fa-plus"></i>
                <span>إنشاء مشروع</span>
              </button>
              <button id="exportProjectsBtn" class="btn btn-outline">
                <i class="fas fa-download"></i>
                <span>تصدير البيانات</span>
              </button>
              <div class="projects-sync">
                <i class="fas fa-database"></i>
                <span>آخر مزامنة:</span>
                <strong id="lastSyncLabel">—</strong>
              </div>
            </div>
          </header>
          <div class="projects-summary-grid" id="summaryCards"></div>
        </div>

        <div class="project-canvas">
          <section id="projectsPipelineSection" class="section-card fade-in space-y-6">
            <div class="section-toolbar">
              <div>
                <h2>منظومة التصفية الذكية</h2>
                <p class="text-muted">تحكم بجميع المؤشرات عبر البحث، التصفية، وترتيب المشاريع.</p>
              </div>
              <div class="section-toolbar__actions">
                <button id="toggleViewBtn" class="btn btn-light">
                  <i class="fas fa-table"></i>
                  <span id="toggleViewLabel">عرض لوحة البيانات</span>
                </button>
                <button id="resetFiltersBtn" class="btn btn-ghost">
                  <i class="fas fa-undo"></i>
                  <span>إعادة التصفية</span>
                </button>
              </div>
            </div>
            <div class="projects-filters" id="filtersForm">
              <div class="filter-group">
                <label class="text-xs font-semibold text-text-secondary">الحالة</label>
                <select id="statusFilter">
                  <option value="all">جميع الحالات</option>
                  <option value="active">نشط</option>
                  <option value="planning">قيد التخطيط</option>
                  <option value="on-hold">معلق</option>
                  <option value="completed">منجز</option>
                </select>
              </div>
              <div class="filter-group">
                <label class="text-xs font-semibold text-text-secondary">مستوى المخاطر</label>
                <select id="riskFilter">
                  <option value="all">جميع المستويات</option>
                  <option value="low">منخفض</option>
                  <option value="medium">متوسط</option>
                  <option value="high">مرتفع</option>
                </select>
              </div>
              <div class="filter-group">
                <label class="text-xs font-semibold text-text-secondary">مدير المشروع</label>
                <select id="managerFilter">
                  <option value="all">جميع المدراء</option>
                </select>
              </div>
              <div class="filter-group filter-group--search">
                <label class="text-xs font-semibold text-text-secondary">بحث في المشاريع</label>
                <div class="search-field">
                  <i class="fas fa-search"></i>
                  <input id="projectSearch" type="search" placeholder="ابحث بالاسم، العميل، المدينة أو معرف المشروع" />
                </div>
              </div>
              <div class="filter-group">
                <label class="text-xs font-semibold text-text-secondary">المدة المتبقية</label>
                <select id="timelineFilter">
                  <option value="all">جميع الفترات</option>
                  <option value="lt90">أقل من 90 يوم</option>
                  <option value="lt180">أقل من 180 يوم</option>
                  <option value="gt180">أكثر من 180 يوم</option>
                </select>
              </div>
            </div>
          </section>

          <section id="projectsDataSection" class="projects-data-grid">
            <div class="section-card fade-in">
              <div class="section-toolbar">
                <div>
                  <h2>قائمة المشاريع</h2>
                  <p class="text-muted">
                    تم العثور على <strong id="projectsCount" class="text-primary">0</strong> مشروع وفق التصفية الحالية.
                  </p>
                </div>
                <div class="projects-legend">
                  <span><i class="fas fa-circle text-success"></i> في الموعد</span>
                  <span><i class="fas fa-circle text-warning"></i> يحتاج متابعة</span>
                  <span><i class="fas fa-circle text-danger"></i> متعثر</span>
                </div>
              </div>
              <div class="projects-grid" data-projects-grid></div>
              <div class="projects-grid-summary" id="projectsGridSummary">
                <article class="projects-grid-summary__metric">
                  <span>عدد المشاريع</span>
                  <strong id="projectsGridSummaryCount">0</strong>
                  <small>إجمالي المشاريع المطابقة للتصفية</small>
                </article>
                <article class="projects-grid-summary__metric">
                  <span>القيمة التعاقدية</span>
                  <strong id="projectsGridSummaryContract">0 ريال</strong>
                  <small>إجمالي العقود للمشاريع المحددة</small>
                </article>
                <article class="projects-grid-summary__metric">
                  <span>إجمالي المصاريف</span>
                  <strong id="projectsGridSummaryExpenses">0 ريال</strong>
                  <small>مصاريف المشاريع حتى الآن</small>
                </article>
                <article class="projects-grid-summary__metric">
                  <span>صافي الربحية</span>
                  <strong id="projectsGridSummaryProfit">0 ريال</strong>
                  <small>الإيرادات مطروحاً منها المصاريف</small>
                </article>
                <article class="projects-grid-summary__metric">
                  <span>متوسط التقدم</span>
                  <strong id="projectsGridSummaryProgress">0%</strong>
                  <small>متوسط نسبة الإنجاز للمشاريع</small>
                </article>
                <article class="projects-grid-summary__metric">
                  <span>الحالات النشطة / المنجزة</span>
                  <strong><span id="projectsGridSummaryActive">0</span> نشط · <span id="projectsGridSummaryCompleted">0</span> منجز</strong>
                  <small>قياس سريع للحالة التنفيذية</small>
                </article>
              </div>
              <div id="projectsEmptyState" class="empty-state hidden">
                <i class="fas fa-folder-open"></i>
                <h3>لا توجد مشاريع مطابقة</h3>
                <p>قم بتعديل معايير التصفية أو أنشئ مشروعاً جديداً الآن.</p>
              </div>
            </div>

            <aside id="projectDetailPanel" class="section-card projects-detail-panel fade-in hidden">
              <div class="projects-detail__header">
                <div class="projects-detail__icon">
                  <i class="fas fa-diagram-project"></i>
                </div>
                <div class="projects-detail__meta">
                  <div class="projects-detail__title">
                    <h3 id="detailName">—</h3>
                    <span id="detailStatus" class="projects-tag neutral">—</span>
                    <span id="detailRisk" class="projects-tag">—</span>
                  </div>
                  <p id="detailClient" class="text-muted">—</p>
                  <p id="detailLocation" class="text-muted text-xs">—</p>
                </div>
              </div>
              <div class="projects-detail__metrics" id="detailMetrics"></div>
              <div>
                <h4>المهام الرئيسية</h4>
                <div id="detailTasks" class="projects-detail__list"></div>
              </div>
              <div>
                <h4>الأحداث القادمة</h4>
                <div id="detailEvents" class="projects-detail__list"></div>
              </div>
              <div>
                <h4>أعضاء الفريق</h4>
                <div id="detailTeam" class="projects-detail__list"></div>
              </div>
              <footer class="projects-detail__footer">
                <button class="btn btn-primary" data-action="open-project">فتح لوحة المشروع</button>
                <button class="btn btn-ghost" data-action="close-panel">إخفاء التفاصيل</button>
              </footer>
            </aside>
          </section>
        </div>
      </main>
    </div>

    <script type="module" src="js/main.js"></script>
  </body>
</html>
